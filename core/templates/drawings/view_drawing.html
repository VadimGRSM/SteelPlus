{% extends "core/base.html" %}
{% load static %}

{% block CSS %}
    <link rel="stylesheet" href="{% static 'core/drawings/style_viev_drawing.css' %}">
{% endblock CSS %}

{% block title %}
    –°—Ç–∞–ª—å+ {{ drawing.name }}
{% endblock title %}

{% block content %}
<div class="page-container">
    <div class="page-header">
        <div class="title-section">
            <h1>{{ drawing.name }}</h1>
            <div class="file-info">
                <span>{{ drawing.file_size|filesizeformat }}</span>
            </div>
        </div>
    </div>

    <div class="content-grid">
        <div class="viewer-panel">
            <div class="viewer-header">
                <div class="viewer-title">
                    <div class="viewer-title-icon">üìÑ</div>
                    –ü–µ—Ä–µ–≥–ª—è–¥ –∫—Ä–µ—Å–ª–µ–Ω—è
                </div>
                <div class="viewer-toolbar">
                    <button class="toolbar-btn">-</button>
                    <div class="zoom-display">100%</div>
                    <button class="toolbar-btn">+</button>
                </div>
            </div>

            <div class="drawing-area">
                {% if img %}
                    <img src="{{ img }}" alt="DXF –ø—Ä–µ–≤—å—é" style="max-width: 100%; height: auto;">
                {% else %}
                    <p>–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω</p>
                {% endif %}
            </div>

            <div class="action-bar">
                <a href="{{ drawing.file_path.url }}" download style="text-decoration: none;">
                    <button class="action-btn primary">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="7,10 12,15 17,10"/>
                            <line x1="12" y1="15" x2="12" y2="3"/>
                        </svg>
                        –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏
                    </button>
                </a>
                <button class="action-btn secondary" id="share-btn">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="18" cy="5" r="3"/>
                        <circle cx="6" cy="12" r="3"/>
                        <circle cx="18" cy="19" r="3"/>
                        <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/>
                        <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/>
                    </svg>
                    –ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è
                </button>
            </div>
        </div>

        <div class="info-block">
            <h3>–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è</h3>
            <div class="info-item">
                <span class="info-label">–û–ø–∏—Å</span>
                <span class="description-value">{{ drawing.description }}</span>
            </div>
            <div class="info-item">
                <span class="info-label">–†–æ–∑–º—ñ—Ä–∏:</span>
                <span class="info-value">
                    {{ sizes.width|floatformat:0 }} √ó {{ sizes.height|floatformat:0 }} –º–º
                </span>
            </div>

            <h3 style="margin-top: 32px;">–ú–µ—Ç–∞–¥–∞–Ω—ñ</h3>
            <div class="metadata-list">
                <div class="metadata-entry">
                    <div class="metadata-details">
                        <div class="label">–î–∞—Ç–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è</div>
                        <div class="value">{{ drawing.uploaded_at }}</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
  document.getElementById('share-btn').addEventListener('click', function() {
    const url = window.location.href
    navigator.clipboard.writeText(url)
      .then(() => {
        alert('URL —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º—ñ–Ω—É!')
      })
      .catch(() => {
        alert('–ù–µ –≤–¥–∞–ª–æ—Å—è —Å–∫–æ–ø—ñ—é–≤–∞—Ç–∏ URL')
      })
  })
</script>

{% endblock content %}
